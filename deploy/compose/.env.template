# A-SWARM Pilot Deployment Configuration
# Copy this file to .env and customize as needed.

###############################################
# Version / Environment
###############################################
ASWARM_VERSION=latest         # Pin to a specific tag for repeatable pilots
ENV=dev
CLUSTER=pilot

###############################################
# Security (CHANGE IN PRODUCTION)
###############################################
# Generate a strong secret before going prod:
#   openssl rand -hex 32
JWT_SECRET=changeme-generate-random-secret
GRAFANA_PASSWORD=admin

# HMAC for UDP ingestion / seed-traffic integrity
EVENT_HMAC_KEY=pilot-shared-secret

# TLS convenience: set to "true" to auto-generate self-signed certs at first boot (demo only)
TLS_SELF_SIGNED=true

###############################################
# Autonomy Control & Guardrails (Safety-first)
###############################################
# Master switch: true=PAUSE evolution (pilot default), false=allow autonomous loop
EVOLUTION_CIRCUIT_BREAKER=true

# Promotion guardrails (from E2 Safety Guardrails)
PROMOTE_MAX_CANARY_PCT=5           # Max % of antibodies in canary at once
ROLLBACK_THRESHOLD=2               # Circuit breaker if >N rollbacks/hour
SAFETY_VIOLATION_LIMIT=0           # Any violation blocks promotion

# Fitness gate (keep conservative for pilots)
FITNESS_THRESHOLD=0.70             # Minimum extended fitness to consider promotion

###############################################
# Learning & Event Bus
###############################################
LEARNING_THRESHOLD=0.5             # Emit learning events when confidence < threshold
EVENT_WAL_PATH=/data/wal           # Write-ahead log path (mounted by compose)
# Optional: raise if you expect bursts
# EVENT_QUEUE_MAX_SIZE=20000

###############################################
# Federation (Pilot defaults: isolated)
###############################################
# Comma-separated peers: example "cluster-2:9443,cluster-3:9443"
FEDERATION_PEERS=
FEDERATION_TRUST_MIN=0.60
FEDERATION_RATE_LIMIT_RPM=600

###############################################
# Observability
###############################################
# Each service exposes Prometheus on :9000 (internal). Don't change unless you know why.
PROMETHEUS_RETENTION=15d           # Prometheus TSDB retention
PROMETHEUS_SCRAPE_INTERVAL=15s
PROMETHEUS_EVAL_INTERVAL=15s       # Rule evaluation interval
PROMETHEUS_SCRAPE_TIMEOUT=10s      # Per-scrape timeout
ASWARM_FAST_SCRAPE_INTERVAL=10s    # Faster interval for UDP listener (queue monitoring)
LOG_LEVEL=info                     # debug|info|warn|error

###############################################
# Seed Traffic (first-boot smoke)
###############################################
ENABLE_SEED_TRAFFIC=true
BURST_COUNT=10
BURST_DELAY=2

###############################################
# Optional resource limits (uncomment to use)
###############################################
# COMPOSE_DOCKER_CLI_BUILD_MEMORY=2g
# COMPOSE_DOCKER_CLI_BUILD_CPUS=2